copy from kcp-go master branch , commitid: e228bdb064e60020b7249ddb62f59611654d0d66